!function(t,e){"function"==typeof define&&define.amd?define("p5.speech",["p5"],function(t){e(t)}):"object"==typeof exports?e(require("../p5")):e(t.p5)}(this,function(t){t.Speech=function(t,e){this.synth=window.speechSynthesis,this.utterance=new SpeechSynthesisUtterance,this.isLoaded=0,this.interrupt=!1,this.onLoad,this.onStart,this.onPause,this.onResume,this.onEnd,this.voices=[],this.initvoice,void 0!==t&&(this.initvoice=t),void 0!==e&&(this.onLoad=e);var n=this;window.speechSynthesis.onvoiceschanged=function(){0==n.isLoaded&&(n.voices=window.speechSynthesis.getVoices(),n.isLoaded=1,console.log("p5.Speech: voices loaded!"),null!=n.initvoice&&(n.setVoice(n.initvoice),console.log("p5.Speech: initial voice: "+n.initvoice)),null!=n.onLoad&&n.onLoad(),n.utterance.onstart=function(t){null!=n.onStart&&n.onStart(t)},n.utterance.onpause=function(t){null!=n.onPause&&n.onPause(t)},n.utterance.onresume=function(t){null!=n.onResume&&n.onResume(t)},n.utterance.onend=function(t){null!=n.onEnd&&n.onEnd(t)})}},t.Speech.prototype.listVoices=function(){if(this.isLoaded)for(var t=0;t<this.voices.length;t++)console.log(this.voices[t].name);else console.log("p5.Speech: voices not loaded yet!")},t.Speech.prototype.setVoice=function(e){"string"==typeof e?this.utterance.voice=this.voices.filter(function(t){return t.name==e})[0]:"number"==typeof e&&(this.utterance.voice=this.voices[Math.min(Math.max(e,0),this.voices.length-1)])},t.Speech.prototype.setVolume=function(t){this.utterance.volume=Math.min(Math.max(t,0),1)},t.Speech.prototype.setRate=function(t){this.utterance.rate=Math.min(Math.max(t,.1),2)},t.Speech.prototype.setPitch=function(t){this.utterance.pitch=Math.min(Math.max(t,.01),2)},t.Speech.prototype.setLang=function(t){this.utterance.lang=t},t.Speech.prototype.speak=function(t){this.interrupt&&this.synth.cancel(),this.utterance.text=t,this.synth.speak(this.utterance)},t.Speech.prototype.pause=function(){this.synth.pause()},t.Speech.prototype.resume=function(){this.synth.resume()},t.Speech.prototype.stop=function(){this.synth.cancel()},t.Speech.prototype.cancel=function(){this.synth.cancel()},t.Speech.prototype.started=function(t){this.onStart=t},t.Speech.prototype.ended=function(t){this.onEnd=t},t.Speech.prototype.paused=function(t){this.onPause=t},t.Speech.prototype.resumed=function(t){this.onResume=t},t.SpeechRec=function(t,e){"webkitSpeechRecognition"in window?this.rec=new webkitSpeechRecognition:(this.rec=new Object,console.log("p5.SpeechRec: webkitSpeechRecognition not supported in this browser.")),void 0!==t&&(this.rec.lang=t),this.onResult,this.onStart,this.onError,this.onEnd,void 0!==e&&(this.onResult=e),this.continuous=!1,this.interimResults=!1,this.resultJSON,this.resultValue,this.resultString,this.resultConfidence;var n=this;this.rec.onresult=function(t){n.resultJSON=t,n.resultValue=t.returnValue,n.resultString=t.results[t.results.length-1][0].transcript.trim(),n.resultConfidence=t.results[t.results.length-1][0].confidence,null!=n.onResult&&n.onResult()},this.rec.onstart=function(t){null!=n.onStart&&n.onStart(t)},this.rec.onerror=function(t){null!=n.onError&&n.onError(t)},this.rec.onend=function(){null!=n.onEnd&&n.onEnd()}},t.SpeechRec.prototype.start=function(t,e){"webkitSpeechRecognition"in window&&(void 0!==t&&(this.continuous=t),void 0!==e&&(this.interimResults=e),this.rec.continuous=this.continuous,this.rec.interimResults=this.interimResults,this.rec.start())}});